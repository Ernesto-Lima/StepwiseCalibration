%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~%Right Hand Sides of the ODE equations%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~function [F] = rhsparams(t,x,params)%Define parameters based on input    T = x(1);    I = x(2);    V = x(3);g_T = params(1);       u_T = params(2);         a_V = params(3);g_I = params(4);          g_V = params(5);       a_I = params(6);                 u_V = params(7);     K_T = params(8);K_I = params(9);r   = params(10);D   = params(11);    drugT = (1+(D/(K_T+D))*exp(-r*t));    drugI = (1+(D/(K_I+D))*exp(-r*t));   %     %Build the RHS of the the ODEs%     F = [g_T*x(1) - u_T*(1+(D/(K_T+D))*exp(-r*t))*x(2)*x(1);...%          a_V*x(3)*(1 - x(2)) + g_I*(1+(D/(K_I+D))*exp(-r*t))*x(2)*(1 - x(2));...%          g_V*(1 - x(3)) + a_I*x(2)*(1-x(3))- u_V*x(1)*x(3);];     %          %Build the RHS of the the ODEs%     F = [g_T*x(1) - u_T*(1+(D/(K_T+D))*exp(-r*t))*x(2)*x(1);...%          a_V*x(3)*(x(1) - x(2)) + g_I*(1+(D/(K_I+D))*exp(-r*t))*x(2)*(x(1) - x(2));...%          g_V*(x(1) - x(3)) + a_I*x(2)*(x(1)-x(3))- u_V*x(1)*x(3);];         if T<0        T = 0;    end    if I<0        I = 0;    end    if V<0        V = 0;    end%          %Build the RHS of the the ODEs%     F = [g_T*T - u_T*drugT*T*I;...%          g_I*drugI*I*(T - I) + a_V*V*(T - I);...%          g_V*(T + I - V) + a_I*I*(T + I - V)- u_V*T*V;];                   %Build the RHS of the the ODEs    F = [g_T*T - u_T*drugT*T*I;...         g_I*drugI*I*(T - I) + a_V*V*(T - I) - a_I*I*T;...         g_V*(T + I - V) - u_V*T*V;];     end%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~