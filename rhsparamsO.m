%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~%Right Hand Sides of the ODE equations%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~function [F] = rhsparamsO(t,x,p,free,params)    T = x(1);    I = x(2);    V = x(3);    %Define parameters based on input    g_T = params(1);           u_T = params(2);             a_V = params(3);    g_I = params(4);              g_V = params(5);           a_I = params(6);                     u_V = params(7);         K_T = params(8);    K_I = params(9);    r   = params(10);    D   = params(11);    for w = 1:numel(free)        %Setting our "free" control variable from the minimization search        if(free(w)==1)          g_T = p(w);            elseif(free(w)==2)  u_T = p(w);            elseif(free(w)==3)  a_V = p(w);            elseif(free(w)==4)  g_I = p(w);            elseif(free(w)==5)  g_V = p(w);            elseif(free(w)==6)  a_I = p(w);            elseif(free(w)==7)  u_V = p(w);            elseif(free(w)==8)  K_T = p(w);            elseif(free(w)==9)  K_I = p(w);            elseif(free(w)==10) r   = p(w);            elseif(free(w)==11) D   = p(w);        end     end       drugT = (1+(D/(K_T+D))*exp(-r*t));    drugI = (1+(D/(K_I+D))*exp(-r*t));    %     %Build the RHS of the the ODEs%     F = [g_T*T - u_T*drugT*T*I;...%          g_I*drugI*I*(1 - I) + a_V*V*(1 - I);...%          g_V*(1 - V) + a_I*I*(1 - V)- u_V*T*V;];         if T<0        T = 0;    elseif I<0        I = 0;    elseif V<0        V = 0;    end         %Build the RHS of the the ODEs%     F = [g_T*T - u_T*drugT*T*I;...%          g_I*drugI*I*(T-I) + a_V*V*(T-I);...%          g_V*(T + I - V) + a_I*I*(T + I - V)- u_V*T*V;];    F = [g_T*T - u_T*drugT*T*I;...         g_I*drugI*I*(T-I) + a_V*V*(T-I) - a_I*I*T;...         g_V*(T + I - V) - u_V*T*V;];end%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~