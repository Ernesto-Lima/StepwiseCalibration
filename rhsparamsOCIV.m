%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~%Right Hand Sides of the ODE equations%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~function [F] = rhsparamsOCIV(t,x,p,free,params)    C = x(1);    I = x(2);    V = x(3);    %Define parameters based on input    g_C = params(1);     u_C = params(2);    g_I = params(3);    a_V = params(4);    b_I = params(5);    g_V = params(6);     a_I = params(7);    u_V = params(8);     b_V = params(9);    D   = params(10);    r   = params(11);     for w = 1:numel(free)        %Setting our "free" control variable from the minimization search        if(free(w)==1)          g_C = p(w);            elseif(free(w)==2)  u_C = p(w);            elseif(free(w)==3)  g_I = p(w);            elseif(free(w)==4)  a_V = p(w);            elseif(free(w)==5)  b_I = p(w);            elseif(free(w)==6)  g_V = p(w);            elseif(free(w)==7)  a_I = p(w);            elseif(free(w)==8)  u_V = p(w);            elseif(free(w)==9)  b_V = p(w);            elseif(free(w)==10) D   = p(w);            elseif(free(w)==11) r   = p(w);        end     end        if C<0        C = 0;    end    if I<0        I = 0;    end    if V<0        V = 0;    end        if t<3        drug = 1+D*exp(-r*t);    elseif t < 6        drug = 1+D*exp(-r*(t-3));    else        drug = 1+D*exp(-r*(t-6));    end    %Build the RHS of the the ODEs    F = [g_C*C - (u_C*drug)*C*I;...         (g_I*drug)*I*(C-I) + a_V*V*(C-I) - b_I*I*C;...         (g_V+a_I*I)*(C + I - V) - (u_V-b_V*I)*C*V];end%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~